<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Ø­Ø§Ø³Ø¨Ø© Ø£Ø³Ø¹Ø§Ø± Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ÙŠ</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <h1>ğŸ“ Ø­Ø§Ø³Ø¨Ø© Ø£Ø³Ø¹Ø§Ø± Ù…ÙˆØ§Ø¯ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ÙŠ</h1>

  <label for="numSubjects">ğŸ”¢ ÙƒÙ… Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„ØªÙŠ ØªØ±ÙŠØ¯ Ø§Ø®ØªÙŠØ§Ø±Ù‡Ø§ØŸ</label>
  <input type="number" id="numSubjects" min="1" max="4" value="1" />

  <form id="subjectsForm">
    <div id="subjectsContainer"></div>

    <button type="submit">ğŸ’° Ø§Ø­Ø³Ø¨ Ø§Ù„Ø³Ø¹Ø±</button>
  </form>

  <div id="output" class="result"></div>
  <div id="error" class="error"></div>

  <script>
    const prices = {
      "Ø§Ù„Ù…Ø³Ø¬Ù„": {"Ø«Ù‚Ø§ÙØ§Øª": 30, "Ø£Ø³Ø§Ø³ÙŠØ©": 50},
      "Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ": {"Ø«Ù‚Ø§ÙØ§Øª": 40, "Ø£Ø³Ø§Ø³ÙŠØ©": 60},
      "Ø§Ù„Ù…Ø¨Ø§Ø´Ø±": {"Ø«Ù‚Ø§ÙØ§Øª": 50, "Ø£Ø³Ø§Ø³ÙŠØ©": 70},
    };

    const subjectsContainer = document.getElementById('subjectsContainer');
    const numSubjectsInput = document.getElementById('numSubjects');
    const form = document.getElementById('subjectsForm');
    const outputDiv = document.getElementById('output');
    const errorDiv = document.getElementById('error');

    function createSubjectInputs(index) {
      const div = document.createElement('div');
      div.className = 'subject-block';

      const labelSystem = document.createElement('label');
      labelSystem.textContent = `ğŸ“š Ù†ÙˆØ¹ Ø§Ù„Ù†Ø¸Ø§Ù… Ù„Ù„Ù…Ø§Ø¯Ø© Ø±Ù‚Ù… ${index + 1}:`;
      const selectSystem = document.createElement('select');
      selectSystem.name = `system_${index}`;
      const optionDefaultSys = document.createElement('option');
      optionDefaultSys.textContent = '-- Ø§Ø®ØªØ± Ø§Ù„Ù†Ø¸Ø§Ù… --';
      optionDefaultSys.value = '';
      selectSystem.appendChild(optionDefaultSys);
      ["Ø§Ù„Ù…Ø³Ø¬Ù„", "Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ", "Ø§Ù„Ù…Ø¨Ø§Ø´Ø±"].forEach(sys => {
        const opt = document.createElement('option');
        opt.value = sys;
        opt.textContent = sys;
        selectSystem.appendChild(opt);
      });

      const labelType = document.createElement('label');
      labelType.textContent = `ğŸ“˜ Ù†ÙˆØ¹ Ø§Ù„Ù…Ø§Ø¯Ø© Ø±Ù‚Ù… ${index + 1}:`;
      const selectType = document.createElement('select');
      selectType.name = `type_${index}`;
      const optionDefaultType = document.createElement('option');
      optionDefaultType.textContent = '-- Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ¹ --';
      optionDefaultType.value = '';
      selectType.appendChild(optionDefaultType);
      ["Ø«Ù‚Ø§ÙØ§Øª", "Ø£Ø³Ø§Ø³ÙŠØ©"].forEach(type => {
        const opt = document.createElement('option');
        opt.value = type;
        opt.textContent = type;
        selectType.appendChild(opt);
      });

      div.appendChild(labelSystem);
      div.appendChild(selectSystem);
      div.appendChild(labelType);
      div.appendChild(selectType);

      return div;
    }

    function renderSubjects() {
      subjectsContainer.innerHTML = '';
      let n = parseInt(numSubjectsInput.value);
      if (isNaN(n) || n < 1) n = 1;
      if (n > 4) n = 4;
      for (let i = 0; i < n; i++) {
        subjectsContainer.appendChild(createSubjectInputs(i));
      }
      outputDiv.style.display = 'none';
      errorDiv.style.display = 'none';
    }

    numSubjectsInput.addEventListener('change', renderSubjects);

    form.addEventListener('submit', e => {
      e.preventDefault();
      errorDiv.textContent = '';
      errorDiv.style.display = 'none';
      outputDiv.style.display = 'none';

      const formData = new FormData(form);
      const subjects = [];

      const numSubjects = parseInt(numSubjectsInput.value);

      for (let i = 0; i < numSubjects; i++) {
        const system = formData.get(`system_${i}`);
        const type = formData.get(`type_${i}`);

        if (!system || !type) {
          errorDiv.textContent = `âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„Ù†Ø¸Ø§Ù… ÙˆÙ†ÙˆØ¹ Ø§Ù„Ù…Ø§Ø¯Ø© Ù„Ù„Ù…Ø§Ø¯Ø© Ø±Ù‚Ù… ${i + 1}`;
          errorDiv.style.display = 'block';
          return;
        }

        subjects.push({system, type});
      }

      let total_price = 0;
      subjects.forEach(sub => {
        total_price += prices[sub.system][sub.type];
      });

      let discount = 0;
      if (numSubjects === 2) discount = 0.20;
      else if (numSubjects === 3 || numSubjects === 4) discount = 0.30;

      const final_price = total_price * (1 - discount);

      outputDiv.innerHTML = `
        <p>ğŸ’µ Ø§Ù„Ø³Ø¹Ø± Ù‚Ø¨Ù„ Ø§Ù„Ø®ØµÙ…: <strong>${total_price} Ø¯ÙŠÙ†Ø§Ø±</strong></p>
        <p>ğŸ Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ…: <strong>${discount * 100}%</strong></p>
        <p>âœ… Ø§Ù„Ø³Ø¹Ø± Ø¨Ø¹Ø¯ Ø§Ù„Ø®ØµÙ…: <strong>${final_price.toFixed(2)} Ø¯ÙŠÙ†Ø§Ø±</strong></p>
      `;
      outputDiv.style.display = 'block';
    });

    renderSubjects();
  </script>

</body>
</html>
